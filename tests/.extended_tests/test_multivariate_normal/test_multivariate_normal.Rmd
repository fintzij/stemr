---
title: "Multivariate Normal benchmarks"
author: "Jon Fintzi"
date: "October 8, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = T)
```

## R Markdown
This vignette benchmarks the multivariate normal simulation functions in the `stemr` package against the `mvtnorm` package.

```{r, cache = T}
library(stemr)
library(mvtnorm)
library(ggplot2)

nsim <- 5e5
stemr_1   <- stemr::rmvtn(nsim, mu = c(0,0), sigma = diag(1,2))
mvtnorm_1 <- mvtnorm::rmvnorm(nsim, mean = c(0,0), sigma = diag(1,2))

results_1 <- data.frame(method = rep(c("stemr", "mvtnorm"), each = nsim),
                      x1 = c(stemr_1[,1], mvtnorm_1[,1]),
                      x2 = c(stemr_1[,2], mvtnorm_1[,2]))

ggplot(results_1, aes(x = x1, y = x2, colour = method, linetype = method)) + geom_density2d() + labs(main = "Standard Normal")
```

```{r, cache = T}
stemr_2   <- stemr::rmvtn(nsim, mu = c(1,-2), sigma = matrix(c(1,-0.5,-0.5,1), 2))
mvtnorm_2 <- mvtnorm::rmvnorm(nsim, mean = c(1,-2), sigma =  matrix(c(1,-0.5,-0.5,1), 2))

results_2 <- data.frame(method = rep(c("stemr", "mvtnorm"), each = nsim),
                      x1 = c(stemr_2[,1], mvtnorm_2[,1]),
                      x2 = c(stemr_2[,2], mvtnorm_2[,2]))

ggplot(results_2, aes(x = x1, y = x2, colour = method, linetype = method)) + geom_density2d() + labs(main = "Mean = c(1,-2), Sigma = matrix(c(1,-0.5,-0.5,1), 2)")
```

```{r}
stemr_3   <- stemr::rmvtn(nsim, mu = c(3,2), sigma = matrix(c(1,0.5,0.5,1), 2))
mvtnorm_3 <- mvtnorm::rmvnorm(nsim, mean = c(3,2), sigma =  matrix(c(1,0.5,0.5,1), 2))

results_3 <- data.frame(method = rep(c("stemr", "mvtnorm"), each = nsim),
                      x1 = c(stemr_3[,1], mvtnorm_3[,1]),
                      x2 = c(stemr_3[,2], mvtnorm_3[,2]))

ggplot(results_3, aes(x = x1, y = x2, colour = method, linetype = method)) + geom_density2d() + labs(main = "Mean 0, Sigma = matrix(c(1,0.5,0.5,1), 2)")
```
