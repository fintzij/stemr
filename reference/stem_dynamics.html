<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate the objects governing the dynamics of a stochastic epidemic model. — stem_dynamics • stemr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate the objects governing the dynamics of a stochastic epidemic model. — stem_dynamics"><meta property="og:description" content="Generate the objects governing the dynamics of a stochastic epidemic model."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stemr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/stemr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ebola_westafrica.html">Fitting a multi-country model for Ebola transmission in West Africa using the stemr package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fintzij/stemr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate the objects governing the dynamics of a stochastic epidemic model.</h1>
    <small class="dont-index">Source: <a href="https://github.com/fintzij/stemr/blob/HEAD/R/stem_dynamics.R" class="external-link"><code>R/stem_dynamics.R</code></a></small>
    <div class="hidden name"><code>stem_dynamics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate the objects governing the dynamics of a stochastic epidemic model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">stem_dynamics</span><span class="op">(</span>
  <span class="va">rates</span>,
  <span class="va">parameters</span>,
  <span class="va">state_initializer</span>,
  <span class="va">compartments</span>,
  <span class="va">tmax</span>,
  tparam <span class="op">=</span> <span class="cn">NULL</span>,
  tcovar <span class="op">=</span> <span class="cn">NULL</span>,
  forcings <span class="op">=</span> <span class="cn">NULL</span>,
  strata <span class="op">=</span> <span class="cn">NULL</span>,
  constants <span class="op">=</span> <span class="cn">NULL</span>,
  timestep <span class="op">=</span> <span class="cn">NULL</span>,
  adjacency <span class="op">=</span> <span class="cn">NULL</span>,
  messages <span class="op">=</span> <span class="cn">FALSE</span>,
  compile_rates <span class="op">=</span> <span class="cn">TRUE</span>,
  compile_lna <span class="op">=</span> <span class="cn">TRUE</span>,
  compile_ode <span class="op">=</span> <span class="cn">TRUE</span>,
  step_size <span class="op">=</span> <span class="fl">1e-06</span>,
  stepper <span class="op">=</span> <span class="st">"rk54_a"</span>,
  rtol <span class="op">=</span> <span class="fl">1e-06</span>,
  atol <span class="op">=</span> <span class="fl">1e-06</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rates</dt>
<dd><p>list of rate lists, each generated by a call to the
<code>rate</code> function.</p></dd>
<dt>parameters</dt>
<dd><p>numeric vector with named elements, the model parameters.
Note that this includes ALL model parameters, including those referred to in
the measurement process. Importantly, if there is a time-varying parameter
in the model it should not be included in the <code>parameters</code> argument,
but rather specified separately in the <code>tparam</code> argument. However, if
the time-varying parameter depends on hyperparameters that are updated via
MCMC, the hyperparameters should be included in the vector of parameters.</p></dd>
<dt>state_initializer</dt>
<dd><p>list of initializer lists, each generated by a call
to <code>stem_initializer</code>. Used to initialize the system at the
first observation time.</p></dd>
<dt>compartments</dt>
<dd><p>character vector of compartment names if there is a single
stratum, or if there are multiple strata a list of character vectors where
the name of each character vector is the compartment name and the character
vector lists the strata to in which the compartment exists. The reserved
word "ALL" can be used instead of listing all strata.</p></dd>
<dt>tmax</dt>
<dd><p>the time at which simulation of the system is terminated.
Defaults to the last observation time if not supplied.</p></dd>
<dt>tparam</dt>
<dd><p>list of time-varying parameter lists, each generated by a call
to the <code>tparam</code> function. Time-varying parameters are defined by
mapping vectors of N(0,1) draws to parameter values and are updated jointly
via elliptical slice sampling.</p></dd>
<dt>tcovar</dt>
<dd><p>Matrix of time varying covariates, the first
column of which contains the times at which covariates change. Note that if
a covariate modifies the model compartment counts (e.g., vaccination), the
flow between model compartments must also be declared using a list of
forcing functions, supplied in the <code>forcings</code> argument (see the
documentation for the <code>forcing</code> function).</p></dd>
<dt>forcings</dt>
<dd><p>list of forcings, which declare that certain time varying
covariates modify compartment counts, each generated by a call to the
<code>forcing</code> function.</p></dd>
<dt>strata</dt>
<dd><p>vector of stratum names, required if the "ALL" reserved word is
 used</p>
<p>(e.g. compartments = list(S = "ALL", I = "ALL", R = "ALL", D = "old");
 strata = c("infants", "young", "old");</p></dd>
<dt>constants</dt>
<dd><p>optional. numeric vector with named elements that are
constants referenced in the rate functions.</p></dd>
<dt>adjacency</dt>
<dd><p>optional matrix specifying the adjacency structure of strata,
 with 0 entries indicating non-adjacency and 1 for adjacency. Rows and
 columns must be labeled.</p>
<p>Important note: care should be taken to make sure that there are no partial
 string matches between the building blocks of a model. For example, if the
 population size is given by the string constant "N", then "N" should not
 appear in any of parameter names, compartment names, etc. In particular,
 suppose there is a parameter named "BETA_N". When the rate functions are
 parsed internally, the rate strings will be parsed incorrectly due to the
 partial match.</p></dd>
<dt>messages</dt>
<dd><p>should a message be printed when parsing the rates?</p></dd>
<dt>compile_rates</dt>
<dd><p>should the rate functions for exact simulation and
inference be compiled?</p></dd>
<dt>compile_lna</dt>
<dd><p>should the LNA functions be compiled?</p></dd>
<dt>compile_ode</dt>
<dd><p>should the ODE functions for the deterministic mean process
be compiled?</p></dd>
<dt>step_size</dt>
<dd><p>initial step size for ODE stepper. Adapted internally, but
too large of an initial size can lead to failures in stiff systems.</p></dd>
<dt>stepper</dt>
<dd><p>string specifying the stepper type (see odeintr package
documentation)</p></dd>
<dt>rtol, atol</dt>
<dd><p>stepper error tolerance (see odeintr package documentation)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>list with evaluated rate functions and objects for managing the
 bookkeeping for epidemic paths. The objects in the list are as follows:</p><dl><dt>rates</dt>
<dd><p>list of parsed rate functions</p></dd>

 <dt>rate_ptrs</dt>
<dd><p>vector of external function pointers to compiled rate
 functions.</p></dd>
 <dt>parameters</dt>
<dd><p>named numeric vector of model parameters</p></dd>

 <dt>tcovar</dt>
<dd><p>matrix of time-varying covariates, with column names</p></dd>

 <dt>constants</dt>
<dd><p>named numeric vector of constants, with stratum sizes and
 population size included</p></dd>
 <dt>state_initializer</dt>
<dd><p>list of model initializer
 lists</p></dd>
 <dt>initdist_params</dt>
<dd><p>named numeric vector of parameters governing
 the initial distribution of compartment counts</p></dd>
 <dt>fixed_inits</dt>
<dd><p>logical
 indicating whether the initial distribution parameters are fixed compartment
 counts (TRUE) or parameters of a dirichlet distribution (FALSE)</p></dd>

 <dt>flow_matrix</dt>
<dd><p>matrix of flow between model compartments associated with
 each transition event</p></dd>
 <dt>lna_rates</dt>
<dd><p>list with lna pointers and lna code</p></dd>

 <dt>strata_sizes</dt>
<dd><p>named numeric vector of strata sizes</p></dd>

 <dt>popsize</dt>
<dd><p>population size</p></dd>
 <dt>comp_codes</dt>
<dd><p>named vector of (C++)
 compartment codes</p></dd>
 <dt>param_codes</dt>
<dd><p>named vector of (C++) parameter codes</p></dd>

 <dt>tcovar_codes</dt>
<dd><p>named vector of (C++) time-varying covariate codes</p></dd>

 <dt>const_codes</dt>
<dd><p>named vector of (C++) constant codes</p></dd>

 <dt>strata_codes</dt>
<dd><p>named vector of (C++) strata codes</p></dd>

 <dt>incidence_codes</dt>
<dd><p>named vector of (C++) incidence compartment codes
 (colum location in the path matrix)</p></dd>
 <dt>incidence_sources</dt>
<dd><p>named vector
 of (C++) codes for compartments corresponding to each incidence compartment</p></dd>

 <dt>lna_param_codes</dt>
<dd><p>named vector of (C++) codes for the concatenated LNA
 parameters</p></dd>
 <dt>progressive</dt>
<dd><p>logical indicating whether the model is
 progressive</p></dd>
 <dt>absorbing_states</dt>
<dd><p>logical vector indicating which model
 compartments are absorbing states</p></dd>
 <dt>rate_adjmat</dt>
<dd><p>adjacency matrix
 indicating which rates need to be updated when a transition event occurs</p></dd>

 <dt>timevarying</dt>
<dd><p>logical indicating whether there are any time-varying
 covariates or parameters</p></dd>
 <dt>timecode</dt>
<dd><p>index of column in the
 time-varying covariate matrix for time (as a variable, not an index)</p></dd>

 <dt>tcovar_adjmat</dt>
<dd><p>adjacency matrix indicating which rates need to be
 updated when a time-varying covariate value changes</p></dd>

 <dt>tcovar_changemat</dt>
<dd><p>indicator matrix indicating which time-varying
 covariates change at which time in the tcovar matrix</p></dd>

 <dt>t0</dt>
<dd><p>initialization time for the system</p></dd>
 <dt>tmax</dt>
<dd><p>time until which
 the system evolves</p></dd>
 <dt>n_strata</dt>
<dd><p>number of strata</p></dd>

 <dt>n_compartments</dt>
<dd><p>number of compartments</p></dd>
 <dt>n_params</dt>
<dd><p>number of
 model parameters</p></dd>
 <dt>n_tcovar</dt>
<dd><p>number of time-varying covariates,
 including time</p></dd>
 <dt>n_consts</dt>
<dd><p>number of constants in the model</p></dd>

 <dt>dynamics_args</dt>
<dd><p>original arguments supplied to <code>stem_dynamics</code></p></dd>
 
</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jon Fintzi, Damon Bayer, Jon Wakefield, Vladimir Minin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

