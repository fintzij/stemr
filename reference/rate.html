<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generates a rate list to be supplied to the stem_dynamics 
funciton. — rate • stemr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generates a rate list to be supplied to the stem_dynamics 
funciton. — rate"><meta property="og:description" content="Generates a rate list to be supplied to the stem_dynamics 
funciton."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stemr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/stemr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ebola_westafrica.html">Fitting a multi-country model for Ebola transmission in West Africa using the stemr package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fintzij/stemr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates a rate list to be supplied to the <code><a href="stem_dynamics.html">stem_dynamics</a></code> 
funciton.</h1>
    <small class="dont-index">Source: <a href="https://github.com/fintzij/stemr/blob/HEAD/R/rate.R" class="external-link"><code>R/rate.R</code></a></small>
    <div class="hidden name"><code>rate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a rate list to be supplied to the <code><a href="stem_dynamics.html">stem_dynamics</a></code> 
funciton.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">rate</span><span class="op">(</span><span class="va">rate</span>, <span class="va">from</span>, <span class="va">to</span>, strata <span class="op">=</span> <span class="cn">NULL</span>, incidence <span class="op">=</span> <span class="cn">FALSE</span>, lumped <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rate</dt>
<dd><p>string for computing the rate (unlumped by default unless 
<code>lumped=TRUE</code>)</p></dd>
<dt>from</dt>
<dd><p>compartment from which an individual exits, a string</p></dd>
<dt>to</dt>
<dd><p>compartment into which an individual enters, a string</p></dd>
<dt>strata</dt>
<dd><p>character vector of strata to which the rate applies, may be 
supplied as "ALL"</p></dd>
<dt>incidence</dt>
<dd><p>should an artificial compartment be created for th purpose 
of simulating or making inference based on incidence data for this 
transition or set of transitions? Defaults to FALSE.</p></dd>
<dt>lumped</dt>
<dd><p>is the rate string provided on the lumped state space of 
compartment counts.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>rate list</p>
    </div>
    <div id="specifying-the-rate-functions">
    <h2>Specifying the rate functions</h2>
    

  
<p>Each rate list specifies, at a minimum, the rate function, the compartment 
  from which an individual exits, the compartment that she enters. 
  Optionally, the strata to which the rate function applies can be supplied.
  The optional <code>strata</code> argument can either be a character vector of
  strata for which the rate applies, or may be specified as "ALL" if the rate
  function applies to common compartments in all strata. If there are
  multiple strata, the strata argument for each rate is required. If a rate
  is time dependent, the reserved word "TIME" should be used for the time
  variable. For example, "beta * I + eta *TIME" would indicate a linear trend
  in the infectivity rate.</p>  
<p><em>VERY IMPORTANT:</em> The rate functions are assumed to be specified at 
  the subject level and they are parsed internally and converted to lumped 
  rates. For example, in a standard SIR model, the subject-level infectivity 
  and recovery rates are \(\beta * I\) and \(\mu\), whereas the lumped 
  rates which will be generated automatically are \(\beta * I * S\) and 
  \(\mu * I\). When a lumped string is provided, no internal conversion 
  will occur.</p>  
<p>The rate functions should be provided as string snippets of valid C++ code 
  (though if the snippet is a single line, no semicolon needs to be added). 
  Each function is parsed internally for references to parameters, 
  compartments, strata, constants, and the time variable. There are a few 
  case-sensitive reserved words that are provided to facilitate the 
  specification of rate functions when there are multiple strata that factor 
  into a rate: "ALL", "REL", "ADJ", "SELF". "ALL", "REL", and "ADJ" will be 
  parsed as a vector of compartments, and therefore must be wrapped using the
  <code><a href="comp_fcn.html">comp_fcn</a></code> function, which specifies how the compartments in 
  that vector should be aggregated.</p>  
<p>In an SIR model with multiple strata, for example, we could specify 
  infectivity rates as follows:</p><ol><li><p>rate("beta * I_SELF", "S", 
  "I", "ALL"): each susceptible contacts the infecteds within her own stratum
  at rate \(\beta * I\), but does not contract an infection from outside 
  her stratum. This rate applies to subjects in all strata.</p></li>
<li><p>rate("beta 
  * I_SELF^alpha", "S", "I", "ALL"): each susceptible contacts the infecteds 
  within her own stratum at rate \(\beta * I^\alpha\), but does not 
  contract an infection from outside her stratum. Note that the rate will be 
  parsed to produce valid C++, so exponentiation is done using the 
  <code>pow()</code> function.</p></li>
<li><p>rate("beta * comp_fcn(I_ALL, sum)", "S", "I", 
  "ALL"): each susceptible contacts all infecteds in the population at rate 
  \(\beta * \sum_s I_s\), regardless of stratum. Note that 'I_ALL' will be 
  replaced by a vector of I_strata, therefore using 'I_all' outside of a 
  function, e.g. beta * I_ALL, will result in an error. However, beta * 
  comp_fcn(I_ALL, sum) is well defined.</p></li>
<li><p>rate("beta * comp_fcn(I_REL), 
  sum,", "S", "I", c("young", "old")): each suscpetible contacts infecteds in
  the young and old strata with rate beta. N.B. when the "REL" keyword is 
  used in a <code>comp_fcn</code> call, the relevant strata will be pulled from the
  strata supplied in the rate.</p></li>
<li><p>rate("beta1 * I_SELF + beta2 * 
  comp_fcn(I_ADJ, sum)", "S", "I", "ALL"): each susceptible contacts 
  infecteds in her own stratum at rate \(\beta1 * I_SELF\), and contacts 
  infecteds in adjacent strata (specified in the adjacency matrix) at rate 
  \(\beta * \sum_{s: stratum 's' is adjacent} I_s\). Note that in this 
  case, the diagonal entries in the adjacency matrix should be set to zero.</p></li>
</ol><p>The <code>from</code> and <code>to</code> arguments will automatically be updated when 
  the rate is parsed within the <code>stem_dynamics</code> function to reflect the 
  strata if there are multiple strata in the event that no strata are 
  specified in those arguments. Suppose, for example, that we define strata 
  to be two adjacent regions, east and west. The first rate given above will 
  be understood as governing transitions from S_east to I_east, and from 
  S_west to I_west. If we we want to define rates for transitions where a 
  subject crosses strata, we can do so by including the strata in the 
  <code>from</code> and <code>to</code> arguments.</p><ol><li><p>rate("beta * 
  I_SELF", "S", "I_west", "ALL"): all susceptibles contact infecteds in their
  own region at rate \(\beta * I\), but upon becoming infected end up in 
  the infected compartment in the west stratum.</p></li>
</ol><p>Important note: care should be taken to make sure that there are no partial
  string matches between the building blocks of a model. For example, if the 
  population size is given by the string constant "N", then "N" should not 
  appear in any of parameter names, compartment names, etc. In particular, 
  suppose there is a parameter named "BETA_N". When the rate functions are 
  parsed internally, the rate strings will be parsed incorrectly due to the 
  partial match. Thus, it is highly recommended that the names of all model 
  compartment, parameters, time-varying covariates, and constants be at least
  four characters long.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">rate</span><span class="op">(</span><span class="st">"beta*I"</span>, <span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"ALL"</span>, lumped <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "beta*I"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $from</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "S"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "I"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $strata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ALL"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $incidence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lumped</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jon Fintzi, Damon Bayer, Jon Wakefield, Vladimir Minin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

